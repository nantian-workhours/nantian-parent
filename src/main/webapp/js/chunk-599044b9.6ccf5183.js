(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-599044b9"],{"0470":function(e,t,r){},"4b63":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"table"},[r("div",{staticClass:"crumbs"},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",[r("i",{staticClass:"el-icon-lx-remind"}),e._v(" 员工管理")]),r("el-breadcrumb-item",[e._v(" 所在项目")])],1)],1),r("div",{staticClass:"container"},[r("el-form",{attrs:{inline:!0}},[r("el-form-item",{attrs:{label:"客户类别"}},[r("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.queryForm.custType,callback:function(t){e.$set(e.queryForm,"custType",t)},expression:"queryForm.custType"}},e._l(e.dictObj["cust"],function(e,t){return r("el-option",{key:t,attrs:{label:e.dicValue,value:e.dicCode}})}),1)],1),r("el-form-item",{attrs:{label:"项目名称"}},[r("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.queryForm.projectNumber,callback:function(t){e.$set(e.queryForm,"projectNumber",t)},expression:"queryForm.projectNumber"}},e._l(e.projectList,function(e,t){return r("el-option",{key:t,attrs:{label:e.projectName,value:e.projectNumber}})}),1)],1),r("el-form-item",{attrs:{label:"员工姓名"}},[r("el-input",{attrs:{placeholder:"员工姓名",clearable:""},model:{value:e.queryForm.userName,callback:function(t){e.$set(e.queryForm,"userName",t)},expression:"queryForm.userName"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.findAll(e.queryForm)}}},[e._v("查询")]),"0"!==e.jur?r("el-button",{attrs:{type:"danger"},on:{click:function(t){e.showDialog=!0}}},[e._v("关联员工")]):e._e()],1)],1),r("el-table",{staticClass:"table",attrs:{data:e.tableData,border:"",height:"260"}},[r("el-table-column",{attrs:{prop:"userName",label:"员工姓名"}}),r("el-table-column",{attrs:{prop:"idNo",label:"身份证号"}}),r("el-table-column",{attrs:{prop:"deptName",label:"部门"}}),r("el-table-column",{attrs:{prop:"custTypeName",label:"客户类别"}}),r("el-table-column",{attrs:{prop:"projectName",label:"项目名称"}}),r("el-table-column",{attrs:{prop:"workTypeName",label:"工作类别"}}),r("el-table-column",{attrs:{prop:"workLevelName",label:"技术等级"}}),r("el-table-column",{attrs:{prop:"projectBegdate",label:"开始日期",formatter:e.dateFmt}}),r("el-table-column",{attrs:{prop:"projectEnddate",label:"结束日期",formatter:e.dateFmt}}),r("el-table-column",{attrs:{prop:"status",label:"在场状态",formatter:e.statusFmt}}),r("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(r){return e.editFn(t.row)}}},[e._v("编辑")])]}}])})],1)],1),r("el-dialog",{attrs:{title:"关联员工",visible:e.showDialog},on:{"update:visible":function(t){e.showDialog=t},close:e.onClose}},[r("el-form",{ref:"dialogForm",staticStyle:{width:"600px"},attrs:{model:e.dialogForm,rules:e.rules,"label-width":e.formLabelWidth}},[r("el-form-item",{attrs:{label:"员工姓名",prop:"name"}},[r("el-input",{staticStyle:{width:"75%"},attrs:{placeholder:"输入员工姓名进行查询"},model:{value:e.dialogForm.name,callback:function(t){e.$set(e.dialogForm,"name",t)},expression:"dialogForm.name"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.findByName},slot:"append"})],1)],1),r("el-form-item",{attrs:{label:"身份证号",prop:"idNo"}},[r("el-input",{staticClass:"input-width",attrs:{disabled:"",placeholder:"查询姓名自动带入"},model:{value:e.dialogForm.idNo,callback:function(t){e.$set(e.dialogForm,"idNo",t)},expression:"dialogForm.idNo"}})],1),r("el-form-item",{attrs:{label:"客户类别",prop:"custType"}},[r("el-select",{staticClass:"input-width",attrs:{placeholder:"请选择"},model:{value:e.dialogForm.custType,callback:function(t){e.$set(e.dialogForm,"custType",t)},expression:"dialogForm.custType"}},e._l(e.dictObj["cust"],function(e,t){return r("el-option",{key:t,attrs:{label:e.dicValue,value:e.dicCode}})}),1)],1),r("el-form-item",{attrs:{label:"项目名称",prop:"projectNumber"}},[r("el-select",{staticClass:"input-width",attrs:{placeholder:"请选择"},model:{value:e.dialogForm.projectNumber,callback:function(t){e.$set(e.dialogForm,"projectNumber",t)},expression:"dialogForm.projectNumber"}},e._l(e.projectList,function(e,t){return r("el-option",{key:t,attrs:{label:e.projectName,value:e.projectNumber}})}),1)],1),r("el-form-item",{attrs:{label:"工作类别",prop:"workType"}},[r("el-select",{staticClass:"input-width",attrs:{placeholder:"请选择"},model:{value:e.dialogForm.workType,callback:function(t){e.$set(e.dialogForm,"workType",t)},expression:"dialogForm.workType"}},e._l(e.dictObj["wt"],function(e,t){return r("el-option",{key:t,attrs:{label:e.dicValue,value:e.dicCode}})}),1)],1),r("el-form-item",{attrs:{label:"技术等级",prop:"workLevel"}},[r("el-select",{staticClass:"input-width",attrs:{placeholder:"请选择"},model:{value:e.dialogForm.workLevel,callback:function(t){e.$set(e.dialogForm,"workLevel",t)},expression:"dialogForm.workLevel"}},e._l(e.dictObj["dc"],function(e,t){return r("el-option",{key:t,attrs:{label:e.dicValue,value:e.dicCode}})}),1)],1),r("el-form-item",{attrs:{label:"起始日期"}},[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{prop:"projectBegdateStr"}},[r("el-date-picker",{staticStyle:{width:"160px"},attrs:{type:"date",placeholder:"开始日期"},model:{value:e.dialogForm.projectBegdateStr,callback:function(t){e.$set(e.dialogForm,"projectBegdateStr",t)},expression:"dialogForm.projectBegdateStr"}})],1)],1),r("el-col",{staticClass:"line",attrs:{span:2}},[e._v(" ")]),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{prop:"projectEnddateStr"}},[r("el-date-picker",{staticStyle:{width:"160px"},attrs:{type:"date",placeholder:"结束日期"},model:{value:e.dialogForm.projectEnddateStr,callback:function(t){e.$set(e.dialogForm,"projectEnddateStr",t)},expression:"dialogForm.projectEnddateStr"}})],1)],1)],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.showDialog=!1}}},[e._v("取消")]),e.editFlag?r("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("更新")]):r("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("添加")])],1),r("el-dialog",{attrs:{width:"30%",title:"查询到多条信息, 请选择",visible:e.innerVisible,"append-to-body":"",height:"200"},on:{"update:visible":function(t){e.innerVisible=t}}},[r("el-table",{staticClass:"table",attrs:{data:e.employeeList,border:"",height:"260"}},[r("el-table-column",{attrs:{prop:"name",label:"员工姓名"}}),r("el-table-column",{attrs:{prop:"idNo",label:"身份证号"}}),r("el-table-column",{attrs:{prop:"mobileNo",label:"手机号"}}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){return e.useData(t.row)}}},[e._v("使用")])]}}])})],1)],1)],1)],1)},o=[],l=(r("a342"),r("e6f7"),{data:function(){return{queryForm:{},tableData:[],dialogForm:{},employeeData:{},employeeList:[],formLabelWidth:"120px",showDialog:!1,projectList:[],dictObj:{},editFlag:!1,innerVisible:!1,rules:{name:[{required:!0,message:"请输入必填项",trigger:"blur"}],idNo:[{required:!0,message:"请输入必填项",trigger:"blur"}],custType:[{required:!0,message:"请选择必填项",trigger:"blur"}],projectNumber:[{required:!0,message:"请选择必填项",trigger:"blur"}],workType:[{required:!0,message:"请选择必填项",trigger:"blur"}],workLevel:[{required:!0,message:"请选择必填项",trigger:"blur"}],projectBegdateStr:[{required:!0,message:"请选择必填项",trigger:"blur"}],projectEnddateStr:[{required:!0,message:"请选择必填项",trigger:"blur"}]}}},created:function(){this.initDictData(),this.findAll(),this.jur=this.$store.getters["login/userInfo"].jurisdiction},methods:{update:function(){var e=this;this.$refs["dialogForm"].validate(function(t){if(t){var r=e.dialogForm;r["projectBegdateStr"]=e.formatDate(r.projectBegdateStr,"yyyy-MM-dd"),r["projectEnddateStr"]=e.formatDate(r.projectEnddateStr,"yyyy-MM-dd"),e.$axios.postForm(e.$api.inProject.update,r).then(function(t){200===t.code?(e.$message({message:"更新成功",type:"success"}),e.showDialog=!1,e.editFlag=!1,e.findAll()):e.$message.error("更新失败, 错误信息: "+t.message)})}})},editDataFmt:function(e){var t={id:e.id,perId:e.perId,name:e.userName,idNo:e.idNo,custType:e.custType,projectNumber:e.projectNumber,workType:e.workType,workLevel:e.workLevel,projectBegdateStr:this.formatDate(e.projectBegdate,"yyyy-MM-dd"),projectEnddateStr:this.formatDate(e.projectEnddate,"yyyy-MM-dd")};return t},editFn:function(e){this.editFlag=!0,this.showDialog=!0,this.dialogForm=this.editDataFmt(e)},useData:function(e){this.innerVisible=!1,this.$set(this.dialogForm,"idNo",e.idNo),this.$set(this.dialogForm,"perId",e.perId)},findByName:function(){var e=this,t=this.dialogForm.name;t&&this.$axios.postForm(this.$api.employee.findbyidandname,{name:t}).then(function(t){if(200===t.code){var r=t.data.data;if(!r.length)return e.$message.error("查不到员工信息"),void e.$set(e.dialogForm,"idNo","");if(r.length>1)return e.innerVisible=!0,void(e.employeeList=r);e.employeeData=r[0],e.$set(e.dialogForm,"idNo",r[0].idNo),e.$set(e.dialogForm,"perId",r[0].perId)}})},reset:function(){this.$refs["dialogForm"].resetFields(),this.dialogForm={perId:"",name:"",idNo:"",custType:"",projectNumber:"",workType:"",workLevel:"",projectBegdateStr:"",projectEnddateStr:""}},onClose:function(){this.reset(),this.editFlag=!1},formDataFmt:function(e){return e["projectBegdateStr"]=this.formatDate(e.projectBegdateStr,"yyyy-MM-dd"),e["projectEnddateStr"]=this.formatDate(e.projectEnddateStr,"yyyy-MM-dd"),delete e["name"],e},add:function(){var e=this;this.$refs["dialogForm"].validate(function(t){if(t){var r=e.formDataFmt(e.dialogForm);e.$axios.postForm(e.$api.inProject.add,r).then(function(t){200===t.code&&(e.$message({message:"添加成功",type:"success"}),e.findAll(),e.showDialog=!1)})}})},findAll:function(e){var t=this;this.$axios.postForm(this.$api.inProject.findAll,e).then(function(e){200===e.code&&(t.tableData=e.data.data)})},initDictData:function(){var e=this;this.dictObj=this.$store.state.dict.dictObj,this.$axios.postForm(this.$api.customer.findAll).then(function(t){200===t.code&&(e.projectList=t.data.data)})},statusFmt:function(e,t,r){return 0===r?"在场":"离场"},dateFmt:function(e,t,r){return null!=r?r.split(" ")[0]:"-"}}}),i=l,s=(r("cabf"),r("620d")),n=Object(s["a"])(i,a,o,!1,null,"604779d7",null);t["default"]=n.exports},cabf:function(e,t,r){"use strict";var a=r("0470"),o=r.n(a);o.a}}]);