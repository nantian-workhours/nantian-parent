(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-09f7c212"],{"0511":function(e,t,r){},7499:function(e,t,r){"use strict";var a=r("0511"),o=r.n(a);o.a},cc60:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"crumbs"},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",[r("i",{staticClass:"el-icon-lx-recharge"}),e._v(" 结算管理")]),r("el-breadcrumb-item",[e._v(" 单价管理")])],1)],1),r("div",{staticClass:"container"},[r("el-form",{attrs:{inline:!0,model:e.queryForm,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"客户类别"}},[r("el-select",{attrs:{clearable:""},model:{value:e.queryForm.custType,callback:function(t){e.$set(e.queryForm,"custType",t)},expression:"queryForm.custType"}},e._l(e.custTypeList,function(e,t){return r("el-option",{key:t,attrs:{label:e.dicValue,value:e.dicCode}})}),1)],1),r("el-form-item",{attrs:{label:"工作类别"}},[r("el-select",{attrs:{clearable:""},model:{value:e.queryForm.workType,callback:function(t){e.$set(e.queryForm,"workType",t)},expression:"queryForm.workType"}},e._l(e.workTypeList,function(e,t){return r("el-option",{key:t,attrs:{label:e.dicValue,value:e.dicCode}})}),1)],1),r("el-form-item",{attrs:{label:"选择日期"}},[r("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date",placeholder:"开始日期",clearable:""},model:{value:e.queryForm.projectBegdateStr,callback:function(t){e.$set(e.queryForm,"projectBegdateStr",t)},expression:"queryForm.projectBegdateStr"}}),e._v(" -\r\n                "),r("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date",placeholder:"结束日期",clearable:""},model:{value:e.queryForm.projectEnddateStr,callback:function(t){e.$set(e.queryForm,"projectEnddateStr",t)},expression:"queryForm.projectEnddateStr"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.findAll(e.queryForm)}}},[e._v("查询")]),r("el-button",{attrs:{type:"danger"},on:{click:function(t){e.showDialog=!0}}},[e._v("新增单价")])],1)],1),r("el-table",{staticClass:"table",attrs:{data:e.tableData,border:"",height:"260"}},[r("el-table-column",{attrs:{prop:"custTypeName",label:"客户类别",sortable:""}}),r("el-table-column",{attrs:{prop:"projectNumber",label:"项目名称",formatter:e.proNameFmt,sortable:""}}),r("el-table-column",{attrs:{prop:"workTypeNameList",label:"工作类别",formatter:e.workTypeNameFmt}}),r("el-table-column",{attrs:{prop:"workLevelName",label:"技术等级"}}),r("el-table-column",{attrs:{prop:"levelPrice",label:"等级单价"}}),r("el-table-column",{attrs:{prop:"projectBegdate",label:"开始日期",formatter:e.dateFmt}}),r("el-table-column",{attrs:{prop:"projectEnddate",label:"结束日期",formatter:e.dateFmt}}),r("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(r){return e.editFn(t.row)}}},[e._v("编辑")]),r("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(r){return e.deleteFn(t.row)}}},[e._v("删除")])]}}])})],1)],1),r("el-dialog",{attrs:{title:"单价管理",visible:e.showDialog},on:{"update:visible":function(t){e.showDialog=t},close:e.onClose}},[r("el-form",{ref:"dialogForm",staticStyle:{width:"500px"},attrs:{model:e.dialogForm,rules:e.rules}},[r("el-form-item",{attrs:{label:"客户类别",prop:"custType","label-width":e.formLabelWidth}},[r("el-select",{staticClass:"input-width",attrs:{placeholder:"请选择"},model:{value:e.dialogForm.custType,callback:function(t){e.$set(e.dialogForm,"custType",t)},expression:"dialogForm.custType"}},e._l(e.custTypeList,function(e,t){return r("el-option",{key:t,attrs:{label:e.dicValue,value:e.dicCode}})}),1)],1),r("el-form-item",{attrs:{label:"项目名称",prop:"projectNumber","label-width":e.formLabelWidth}},[r("el-select",{staticClass:"input-width",attrs:{placeholder:"请选择"},model:{value:e.dialogForm.projectNumber,callback:function(t){e.$set(e.dialogForm,"projectNumber",t)},expression:"dialogForm.projectNumber"}},e._l(e.projectList,function(e,t){return r("el-option",{key:t,attrs:{label:e.projectName,value:e.projectNumber}})}),1)],1),r("el-form-item",{attrs:{label:"工作类别",prop:"workType","label-width":e.formLabelWidth}},[r("el-select",{staticClass:"input-width",attrs:{multiple:"",placeholder:"请选择"},model:{value:e.dialogForm.workType,callback:function(t){e.$set(e.dialogForm,"workType",t)},expression:"dialogForm.workType"}},e._l(e.workTypeList,function(e,t){return r("el-option",{key:t,attrs:{label:e.dicValue,value:e.dicCode}})}),1)],1),r("el-form-item",{attrs:{label:"技术等级",prop:"workLevel","label-width":e.formLabelWidth}},[r("el-select",{staticClass:"input-width",attrs:{placeholder:"请选择"},model:{value:e.dialogForm.workLevel,callback:function(t){e.$set(e.dialogForm,"workLevel",t)},expression:"dialogForm.workLevel"}},e._l(e.workLevelList,function(e,t){return r("el-option",{key:t,attrs:{label:e.dicValue,value:e.dicCode}})}),1)],1),r("el-form-item",{attrs:{label:"等级单价",prop:"levelPriceStr","label-width":e.formLabelWidth}},[r("el-input",{staticClass:"input-width",attrs:{type:"input",placeholder:"请输入"},model:{value:e.dialogForm.levelPriceStr,callback:function(t){e.$set(e.dialogForm,"levelPriceStr",t)},expression:"dialogForm.levelPriceStr"}}),e._v(" 元\r\n            ")],1),r("el-form-item",{attrs:{label:"起始日期","label-width":e.formLabelWidth}},[r("el-col",{attrs:{span:11}},[r("el-form-item",{attrs:{prop:"projectBegdateStr"}},[r("el-date-picker",{staticStyle:{width:"160px"},attrs:{type:"date",placeholder:"开始日期"},model:{value:e.dialogForm.projectBegdateStr,callback:function(t){e.$set(e.dialogForm,"projectBegdateStr",t)},expression:"dialogForm.projectBegdateStr"}})],1)],1),r("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),r("el-col",{attrs:{span:11}},[r("el-form-item",{attrs:{prop:"projectEnddateStr"}},[r("el-date-picker",{staticStyle:{width:"160px"},attrs:{type:"date",placeholder:"结束日期"},model:{value:e.dialogForm.projectEnddateStr,callback:function(t){e.$set(e.dialogForm,"projectEnddateStr",t)},expression:"dialogForm.projectEnddateStr"}})],1)],1)],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.showDialog=!1}}},[e._v("取消")]),e.editFlag?r("el-button",{attrs:{type:"primary"},on:{click:e.updateFn}},[e._v("更新")]):r("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("添加")])],1)],1)],1)},o=[],l=(r("a342"),r("d4aa"),{data:function(){return{queryForm:{},dialogForm:{custType:"",projectNumber:"",workType:[],workLevel:"",levelPriceStr:"",projectBegdateStr:"",projectEnddateStr:""},rules:{custType:[{required:!0,message:"请输入必填项",trigger:"blur"}],projectNumber:[{required:!0,message:"请输入必填项",trigger:"blur"}],workType:[{required:!0,message:"请输入必填项",trigger:"blur"}],workLevel:[{required:!0,message:"请输入必填项",trigger:"blur"}],levelPriceStr:[{required:!0,message:"请输入必填项",trigger:"blur"}],projectBegdateStr:[{required:!0,message:"请输入必填项",trigger:"blur"}],projectEnddateStr:[{required:!0,message:"请输入必填项",trigger:"blur"}]},showDialog:!1,formLabelWidth:"120px",addForm:{startDate:"",endDate:""},tableData:[],workTypeList:[],workLevelList:[],custTypeList:[],projectList:[],editFlag:!1}},created:function(){this.findAll(),this.dicListQuery()},methods:{dateFmt:function(e,t,r){return null!=r?r.split(" ")[0]:"-"},workTypeNameFmt:function(e,t,r){return r.join("、")},proNameFmt:function(e,t,r){var a=this.projectList.filter(function(e){return e.projectNumber===r});return a.length?a[0].projectName:"-"},reset:function(){this.$refs["dialogForm"].resetFields(),this.dialogForm={custType:"",projectNumber:"",workType:[],workLevel:"",levelPriceStr:"",projectBegdateStr:"",projectEnddateStr:""}},onClose:function(){this.reset(),this.editFlag=!1},updateFn:function(){var e=this;this.$refs["dialogForm"].validate(function(t){t&&e.$axios.postForm(e.$api.price.update,e.dialogForm).then(function(t){200===t.code?(e.$message({message:"更新成功",type:"success"}),e.showDialog=!1,e.editFlag=!1,e.findAll()):e.$message.error("更新失败, 错误信息: "+t.message)})})},editDataFmt:function(e){var t={};return t["priceId"]=e.priceId,t["custType"]=e.custType,t["projectNumber"]=e.projectNumber,t["workType"]=e.workType.indexOf(",")>-1?e.workType.split(","):e.workType.split(""),t["workLevel"]=e.workLevel,t["levelPriceStr"]=e.levelPrice,t["projectBegdateStr"]=this.formatDate(e.projectBegdate,"yyyy-MM-dd"),t["projectEnddateStr"]=this.formatDate(e.projectEnddate,"yyyy-MM-dd"),t},editFn:function(e){this.editFlag=!0,this.showDialog=!0,this.dialogForm=this.editDataFmt(e)},deleteFn:function(e){var t=this;this.$confirm("确定要进行删除操作吗？").then(function(){t.$axios.get(t.$api.price.delete+"?priceId="+e.priceId).then(function(e){200===e.code&&(t.$message({message:"删除成功",type:"success"}),t.findAll())})}).catch(function(e){})},formDataFmt:function(e){var t=JSON.parse(JSON.stringify(e));return t["projectBegdateStr"]=this.formatDate(t["projectBegdateStr"],"yyyy-MM-dd"),t["projectEnddateStr"]=this.formatDate(t["projectEnddateStr"],"yyyy-MM-dd"),t},add:function(){var e=this;this.formDataFmt(this.dialogForm);this.$refs["dialogForm"].validate(function(t){if(t){var r=e.formDataFmt(e.dialogForm);e.$axios.postForm(e.$api.price.add,r).then(function(t){200===t.code&&(e.$message({message:"添加成功",type:"success"}),e.findAll(),e.showDialog=!1)})}})},findAll:function(e){var t=this;this.$axios.postForm(this.$api.price.findAll,e).then(function(e){200===e.code&&(t.tableData=e.data.data)})},dicListQuery:function(){var e=this;this.$axios.get(this.$api.params.subTypeQuery+"?dicType=wt").then(function(t){e.workTypeList=t.data.res}).catch(function(t){e.$message.error("工作类别数据获取失败")}),this.$axios.get(this.$api.params.subTypeQuery+"?dicType=dc").then(function(t){e.workLevelList=t.data.res}).catch(function(t){e.$message.error("技术等级数据获取失败")}),this.$axios.get(this.$api.params.subTypeQuery+"?dicType=cust").then(function(t){e.custTypeList=t.data.res}).catch(function(t){e.$message.error("客户类别数据获取失败")}),this.$axios.postForm(this.$api.customer.findAll).then(function(t){200===t.code&&(e.projectList=t.data.data)})}}}),i=l,s=(r("7499"),r("620d")),c=Object(s["a"])(i,a,o,!1,null,"bfc1c78a",null);t["default"]=c.exports}}]);